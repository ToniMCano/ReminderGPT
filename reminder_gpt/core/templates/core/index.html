{% extends 'core/base.html' %}


{% block meta %} <!--Para que al volver atrás desde el navegador, la página se refresque, de lo contrarío cargaría desde la caché un CSRF no válido-->
<script>
  window.addEventListener('pageshow', function(event) {
    if (event.persisted) {
      window.location.reload();
    }
  });
</script>
{% endblock meta %}
  

{% block content %}

{% if 'ok' in request.GET %}
  <p><b>Formulario enviado correctamente.</b></p>
{% endif %}

<div class = "container">
  <form method="post" action = ""> 
    {% csrf_token %}  

    {% if form.non_field_errors %}
    
      {% for error in form.non_field_errors %} <!--ES la fomra en que Django comprueba si hay errores no asociados a un campo en concreto-->
      <div class="errores">
          <p>{{ error }}</p>
      </div>
      {% endfor %}

    {% endif %}

    <div>
        <label for="">Usuario</label>
        <div>
            {{ form.user }}
        </div>
        <label for="">Contraseña</label>
        <div>
            {{ form.password }}
        </div>
        <div class = "button">
          <button type="submit" class="btn btn-primary">Entrar</button>
        </div>
        <div class = "button">
          <a href="{% url 'create_user' %}">Registrarse</a>
        </div>
    </div>
  </form>
</div>

{% endblock content %}
  
